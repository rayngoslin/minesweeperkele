<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Minesweeperkele</title>

  <script>
    /**
     * Telegram Mobile WebView cache-buster for fixed bot Mini App URLs.
     *
     * Problem: TG Mobile caches the HTML itself. If HTML is cached, it keeps pointing to old JS/CSS.
     * Fix: On every open, redirect (replace) to the same page with a unique query param.
     *
     * - Does NOT require renaming files
     * - Does NOT require changing bot URL
     * - Works even if TG serves an old cached HTML, because the redirect runs anyway
     */

    (function () {
      const isTelegram = !!(window.Telegram && window.Telegram.WebApp);

      // Only do this aggressive cache-bust inside Telegram.
      if (!isTelegram) return;

      const url = new URL(window.location.href);

      // If we already have a cache-bust param, don't loop.
      if (url.searchParams.has("tgcb")) return;

      // Create a per-open unique value (enough to break TG's cache key)
      const cb = Date.now().toString(36);

      url.searchParams.set("tgcb", cb);

      // IMPORTANT: replace so it doesn't spam history
      window.location.replace(url.toString());
    })();
  </script>

  <!-- Load assets with the same cache-bust token, so TG can't reuse old JS/CSS -->
  <link rel="stylesheet" id="css-link">
  <script id="js-link" defer></script>

  <script>
    (function () {
      const url = new URL(window.location.href);
      const cb = url.searchParams.get("tgcb") || "nocb";

      // If you want: keep filenames stable, bust via query
      document.getElementById("css-link").href = `style.css?tgcb=${cb}`;
      document.getElementById("js-link").src   = `logic.js?tgcb=${cb}`;
    })();
  </script>
</head>

<body>
  <div id="html-debug" style="
  position:fixed; bottom:0; left:0; right:0; z-index:999999;
  background:#000; color:#0f0; padding:6px 10px; font:12px monospace;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">
  HTML BUILD: 2026-01-30-H | URL: <span id="u"></span>
</div>
<script>
  document.getElementById("u").textContent = location.href;
</script>
  
  <div id="hud">
    <span id="bomb-count">Bombs: 0</span>
    <button id="toggle-mode">Switch to Flag Mode</button>
    <button id="restart-btn">Restart</button>
  </div>

  <div id="game-container">
  <div id="board-wrap">
    <div id="board"></div>
  </div>
</div>

</body>
</html>
